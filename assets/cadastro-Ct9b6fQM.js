import"./modulepreload-polyfill-B5Qt9EMX.js";class c{sheetId;accessToken;constructor(e="19B2aMGrajvhPJfOvYXt059-fECytaN38iFsP8GInD_g"){if(this.sheetId=e,this.accessToken=localStorage.getItem("token"),!this.accessToken)throw new Error("Usuário não autenticado. Token não encontrado.")}get headers(){return{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"}}async request(e,o="GET",t){const s=await fetch(e,{method:o,headers:this.headers,body:t?JSON.stringify(t):void 0});if(!s.ok){const a=await s.json();throw console.error("Erro na requisição ao Google Sheets:",a),new Error(a.error.message||"Erro desconhecido")}return s.json()}async getHeaders(e){const o=`${e}!A1:Z1`,t=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${o}`;return(await this.request(t)).values?.[0]??[]}mapObjectToRow(e,o){return o.map(t=>e[t]??"")}async appendRowByHeader(e,o){const t=await this.getHeaders(e);if(t.length===0)throw new Error("Cabeçalhos não encontrados na planilha.");const s=[this.mapObjectToRow(o,t)],a=`${e}!A1`,r=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${a}:append?valueInputOption=RAW`;await this.request(r,"POST",{values:s})}}const d=new c;document.getElementById("formCadastro");document.addEventListener("DOMContentLoaded",()=>{document.getElementById("formCadastro")?.addEventListener("submit",async e=>{e.preventDefault();const o=document.getElementById("nome").value,t=document.getElementById("email").value,s=document.getElementById("obs").value;await d.appendRowByHeader("Cadastro",{Nome:o,Email:t,Observacoes:s}),alert("Cadastro realizado com sucesso!")})});
