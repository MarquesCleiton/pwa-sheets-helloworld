import{G as g,b as w}from"./navigation-D9mB5hQw.js";class v{sheetId;constructor(e="19B2aMGrajvhPJfOvYXt059-fECytaN38iFsP8GInD_g"){this.sheetId=e}async getAccessToken(){await g.authenticate();const e=g.getAccessToken();if(!e)throw new Error("Token de acesso inválido ou ausente.");return e}async getHeadersInit(){return{Authorization:`Bearer ${await this.getAccessToken()}`,"Content-Type":"application/json",Accept:"application/json"}}async request(e,t="GET",n){const a=await this.getHeadersInit(),o=await fetch(e,{method:t,headers:a,body:n?JSON.stringify(n):void 0});if(!o.ok){let s={};try{s=await o.json()}catch{}throw console.error("Erro na requisição ao Google Sheets:",s),new Error(s?.error?.message||`Erro ao acessar o Google Sheets (HTTP ${o.status}).`)}if(!(o.headers.get("content-type")||"").includes("application/json"))try{const s=await o.text();return s?JSON.parse(s):void 0}catch{return}return await o.json()}async getSheetMatrix(e){const t=encodeURIComponent(e),n=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${t}?majorDimension=ROWS`;return(await this.request(n,"GET")).values??[]}async getHeaders(e){const t=await this.getSheetMatrix(e);return t.length===0?[]:(t[0]??[]).map((a,o)=>{const r=String(a??"").trim();return r.length?r:`col_${o+1}`})}async getSheetObjects(e){const t=await this.getSheetMatrix(e);if(t.length===0)return[];const n=(t[0]??[]).map((r,s)=>{const i=String(r??"").trim();return i.length?i:`col_${s+1}`}),a=t.slice(1),o=[];for(const r of a){const s=r.slice(0,n.length);for(;s.length<n.length;)s.push("");const i={};for(let c=0;c<n.length;c++)i[n[c]]=s[c]??"";Object.values(i).every(c=>String(c??"").trim().length===0)||o.push(i)}return o}async getObjectsWithIndex(e){const t=await this.getSheetMatrix(e);if(t.length===0)return[];const n=await this.getHeaders(e),a=[];for(let o=1;o<t.length;o++){const s=(t[o]??[]).slice(0,n.length);for(;s.length<n.length;)s.push("");const i={};n.forEach((h,c)=>i[h]=s[c]??""),a.push({rowIndex:o,rowNumberA1:o+1,object:i})}return a}mapObjectToRow(e,t){return t.map(n=>e[n]??"")}async appendRowByHeader(e,t){const n=await this.getHeaders(e);if(n.length===0)throw new Error("Cabeçalhos não encontrados na planilha.");const a=[this.mapObjectToRow(t,n)],o=`${e}!A1`,r=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${o}:append?valueInputOption=RAW`;await this.request(r,"POST",{values:a})}colToA1(e){let t="",n=e;for(;n>=0;)t=String.fromCharCode(n%26+65)+t,n=Math.floor(n/26)-1;return t}async updateRowByIndex(e,t,n){if(!Number.isInteger(t)||t<1)throw new Error("rowIndex inválido (0 é cabeçalho; use >= 1).");const a=await this.getSheetMatrix(e),o=await this.getHeaders(e);if(a.length===0||o.length===0)throw new Error(`Aba "${e}" vazia.`);if(t>=a.length)throw new Error(`rowIndex ${t} fora dos limites da aba "${e}".`);const r=a[t]??[],s=o.map((u,d)=>{const p=Object.prototype.hasOwnProperty.call(n,u);return String(p?n[u]??"":r[d]??"")}),i=this.colToA1(o.length-1),h=`${e}!A${t+1}:${i}${t+1}`,c=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${encodeURIComponent(h)}?valueInputOption=USER_ENTERED`;await this.request(c,"PUT",{range:h,majorDimension:"ROWS",values:[s]})}async softDeleteRowByIndex(e,t){if(!Number.isInteger(t)||t<1)throw new Error("rowIndex inválido (0 é cabeçalho; use >= 1).");const n=await this.getHeaders(e),a=await this.getSheetMatrix(e);if(a.length===0||n.length===0)throw new Error(`Aba "${e}" vazia.`);if(t>=a.length)throw new Error(`rowIndex ${t} fora dos limites da aba "${e}".`);const o=n.map(()=>"-"),r=this.colToA1(n.length-1),s=`${e}!A${t+1}:${r}${t+1}`,i=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${encodeURIComponent(s)}?valueInputOption=USER_ENTERED`;await this.request(i,"PUT",{range:s,majorDimension:"ROWS",values:[o]})}}async function f(){console.log("Carregando Navbar");const l=await fetch(w("src/presentation/componentes/navbar.html")).then(o=>o.text()),e=document.createElement("div");e.innerHTML=l;const t=e.querySelector("nav");if(!t)return;const n=t.querySelectorAll(".nav-link"),a=window.location.pathname;n.forEach(o=>{const r=o.getAttribute("href");r&&a.includes(r)&&(o.classList.add("nav-active"),o.addEventListener("click",s=>{s.preventDefault()}))}),document.body.appendChild(t),document.body.style.paddingBottom="70px"}export{v as S,f as l};
