import{G as c}from"./GoogleAuthManager-ldm7OoR_.js";class i{sheetId;constructor(e="19B2aMGrajvhPJfOvYXt059-fECytaN38iFsP8GInD_g"){this.sheetId=e}async getAccessToken(){await c.authenticate();const e=c.getAccessToken();if(!e)throw new Error("Token de acesso inválido ou ausente.");return e}async getHeadersInit(){return{Authorization:`Bearer ${await this.getAccessToken()}`,"Content-Type":"application/json"}}async request(e,t="GET",o){const s=await this.getHeadersInit(),a=await fetch(e,{method:t,headers:s,body:o?JSON.stringify(o):void 0});if(!a.ok){const n=await a.json().catch(()=>({}));throw console.error("Erro na requisição ao Google Sheets:",n),new Error(n.error?.message||"Erro desconhecido ao acessar o Google Sheets.")}return a.json()}async getHeaders(e){const t=`${e}!A1:Z1`,o=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${t}`;return(await this.request(o)).values?.[0]??[]}mapObjectToRow(e,t){return t.map(o=>e[o]??"")}async appendRowByHeader(e,t){const o=await this.getHeaders(e);if(o.length===0)throw new Error("Cabeçalhos não encontrados na planilha.");const s=[this.mapObjectToRow(t,o)],a=`${e}!A1`,n=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${a}:append?valueInputOption=RAW`;await this.request(n,"POST",{values:s})}}document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("cadastroForm");if(!r){console.error("Formulário não encontrado!");return}r.addEventListener("submit",async e=>{e.preventDefault();try{const t=document.getElementById("nome").value,o=document.getElementById("email").value,s=document.getElementById("obs").value;await new i().appendRowByHeader("Cadastro",{Nome:t,Email:o,Observacoes:s}),alert("Cadastro realizado com sucesso!"),r.reset()}catch(t){console.error("Erro ao salvar:",t),alert("Erro ao salvar os dados. Verifique o console.")}})});
