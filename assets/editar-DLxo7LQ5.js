import"./GoogleAuthManager-YBajxLns.js";import{S as I}from"./SheetsClient-BqbA6fvN.js";const n=r=>document.querySelector(r),h=(r,o="warning")=>{const e=n("#alert");e&&(e.className=`alert alert-${o}`,e.textContent=r,e.classList.remove("d-none"))};function O(r,o=320){const e=document.querySelector(r);if(!e)return null;const s=()=>{e.style.height="auto";const l=e.scrollHeight;l>o?(e.style.height=`${o}px`,e.style.overflowY="auto"):(e.style.height=`${l}px`,e.style.overflowY="hidden")};return e.addEventListener("input",s),window.addEventListener("resize",s),requestAnimationFrame(s),setTimeout(s,100),{resize:s}}document.addEventListener("DOMContentLoaded",async()=>{const r=new URLSearchParams(location.search),o=r.get("tab")||"Cadastro",e=Number(r.get("rowIndex")||NaN),s=n("#tab"),l=n("#rowIndex"),u=n("#nome"),m=n("#email"),v=n("#observacoes"),y=n("#form"),x=O("#observacoes",320);s&&(s.value=o),l&&(l.value=String(e));const w=new I;try{if(!Number.isInteger(e)||e<1)throw new Error("rowIndex inválido para edição (use >= 1).");const a=await w.getObjectByIndex(o,e);if(!a)throw new Error("Registro não encontrado para o rowIndex informado.");const t=a.object,i=t.Nome??t?.nome??"",b=t.Email??t?.email??"",c=t.Observações??t.Observacoes??t?.observações??t?.observacoes??"";u&&(u.value=String(i)),m&&(m.value=String(b)),v&&(v.value=String(c),x?.resize())}catch(a){h(a?.message||"Erro ao carregar registro para edição.","danger")}y?.addEventListener("submit",async a=>{a.preventDefault();try{const t=await w.getHeaders(o);if(!t.length)throw new Error("Cabeçalhos não encontrados.");const i=d=>{const g=t.map(f=>f.toLowerCase());if(d==="Observacoes"){const f=g.findIndex(E=>b(E));return f>=0?t[f]:"Observacoes"}const p=g.indexOf(d.toLowerCase());return p>=0?t[p]:d},b=d=>d.startsWith("observa"),c={};u&&(c[i("Nome")]=(u.value||"").trim()),m&&(c[i("Email")]=(m.value||"").trim()),v&&(c[i("Observacoes")]=(v.value||"").trim()),await w.updateRowByIndex(o,e,c),h("Registro atualizado com sucesso!","success")}catch(t){h(t?.message||"Erro ao salvar alterações.","danger")}})});
