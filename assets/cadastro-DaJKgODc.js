import"./modulepreload-polyfill-B5Qt9EMX.js";class c{sheetId;accessToken;constructor(e="19B2aMGrajvhPJfOvYXt059-fECytaN38iFsP8GInD_g"){if(this.sheetId=e,this.accessToken=localStorage.getItem("token"),!this.accessToken)throw new Error("Usuário não autenticado. Token não encontrado.")}get headers(){return{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"}}async request(e,t="GET",o){const s=await fetch(e,{method:t,headers:this.headers,body:o?JSON.stringify(o):void 0});if(!s.ok){const a=await s.json();throw console.error("Erro na requisição ao Google Sheets:",a),new Error(a.error.message||"Erro desconhecido")}return s.json()}async getHeaders(e){const t=`${e}!A1:Z1`,o=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${t}`;return(await this.request(o)).values?.[0]??[]}mapObjectToRow(e,t){return t.map(o=>e[o]??"")}async appendRowByHeader(e,t){const o=await this.getHeaders(e);if(o.length===0)throw new Error("Cabeçalhos não encontrados na planilha.");const s=[this.mapObjectToRow(t,o)],a=`${e}!A1`,n=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${a}:append?valueInputOption=RAW`;await this.request(n,"POST",{values:s})}}document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("cadastroForm");if(!r){console.error("Formulário não encontrado!");return}r.addEventListener("submit",async e=>{e.preventDefault();try{const t=document.getElementById("nome").value,o=document.getElementById("email").value,s=document.getElementById("obs").value;await new c().appendRowByHeader("Cadastro",{Nome:t,Email:o,Observacoes:s}),alert("Cadastro realizado com sucesso!"),r.reset()}catch(t){console.error("Erro ao salvar:",t),alert("Erro ao salvar os dados. Verifique o console.")}})});
