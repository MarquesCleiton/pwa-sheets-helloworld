import{G as p}from"./GoogleAuthManager-ldm7OoR_.js";import{S as O}from"./SheetsClient-DdnXSBEg.js";const a=o=>document.querySelector(o),f=(o,r="warning")=>{const t=a("#alert");t&&(t.className=`alert alert-${r}`,t.textContent=o,t.classList.remove("d-none"))};document.addEventListener("DOMContentLoaded",async()=>{const o=new URLSearchParams(location.search),r=o.get("tab")||"Cadastro",t=Number(o.get("rowIndex")||NaN),b=a("#tab"),g=a("#rowIndex"),c=a("#nome"),d=a("#email"),m=a("#observacoes"),x=a("#form");b&&(b.value=r),g&&(g.value=String(t));const w=new O;try{if(!Number.isInteger(t)||t<1)throw new Error("rowIndex inválido para edição (use >= 1).");await p.authenticate();const e=(await w.getObjectsWithIndex(r)).find(u=>u.rowIndex===t)?.object;if(!e)throw new Error("Registro não encontrado para o rowIndex informado.");const n=e.Nome??e?.nome??"",s=e.Email??e?.email??"",i=e.Observações??e.Observacoes??e?.observações??e?.observacoes??"";c&&(c.value=String(n)),d&&(d.value=String(s)),m&&(m.value=String(i))}catch(l){f(l?.message||"Erro ao carregar registro para edição.","danger")}x?.addEventListener("submit",async l=>{l.preventDefault();try{await p.authenticate();const e=await w.getHeaders(r),n=i=>{const u=e.map(v=>v.toLowerCase());if(i==="Observacoes"){const v=u.findIndex(I=>I.startsWith("observa"));return v>=0?e[v]:"Observacoes"}const h=u.indexOf(i.toLowerCase());return h>=0?e[h]:i},s={};c&&(s[n("Nome")]=(c.value||"").trim()),d&&(s[n("Email")]=(d.value||"").trim()),m&&(s[n("Observacoes")]=(m.value||"").trim()),await w.updateRowByIndex(r,t,s),f("Registro atualizado com sucesso!","success")}catch(e){f(e?.message||"Erro ao salvar alterações.","danger")}})});
