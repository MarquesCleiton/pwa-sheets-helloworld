import{G as d,b as u}from"./navigation-D9mB5hQw.js";class v{sheetId;constructor(e="19B2aMGrajvhPJfOvYXt059-fECytaN38iFsP8GInD_g"){this.sheetId=e}async getAccessToken(){await d.authenticate();const e=d.getAccessToken();if(!e)throw new Error("Token de acesso inválido ou ausente.");return e}async getHeadersInit(){return{Authorization:`Bearer ${await this.getAccessToken()}`,"Content-Type":"application/json"}}async request(e,t="GET",s){const o=await this.getHeadersInit(),n=await fetch(e,{method:t,headers:o,body:s?JSON.stringify(s):void 0});if(!n.ok){const a=await n.json().catch(()=>({}));throw console.error("Erro na requisição ao Google Sheets:",a),new Error(a.error?.message||"Erro desconhecido ao acessar o Google Sheets.")}return n.json()}async getHeaders(e){const t=`${e}!A1:Z1`,s=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${t}`;return(await this.request(s)).values?.[0]??[]}mapObjectToRow(e,t){return t.map(s=>e[s]??"")}async appendRowByHeader(e,t){const s=await this.getHeaders(e);if(s.length===0)throw new Error("Cabeçalhos não encontrados na planilha.");const o=[this.mapObjectToRow(t,s)],n=`${e}!A1`,a=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${n}:append?valueInputOption=RAW`;await this.request(a,"POST",{values:o})}async getSheetMatrix(e){const t=encodeURIComponent(e),s=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${t}?majorDimension=ROWS`;return(await this.request(s,"GET")).values??[]}async getSheetObjects(e){const t=await this.getSheetMatrix(e);if(t.length===0)return[];const o=(t[0]??[]).map((i,h)=>{const r=String(i??"").trim();return r.length?r:`col_${h+1}`}),n=t.slice(1),a=[];for(const i of n){const h=i.slice(0,o.length);for(;h.length<o.length;)h.push("");const r={};for(let c=0;c<o.length;c++)r[o[c]]=h[c]??"";Object.values(r).every(c=>String(c??"").trim().length===0)||a.push(r)}return a}}async function m(){console.log("Carregando Navbar");const l=await fetch(u("src/presentation/componentes/navbar.html")).then(n=>n.text()),e=document.createElement("div");e.innerHTML=l;const t=e.querySelector("nav");if(!t)return;const s=t.querySelectorAll(".nav-link"),o=window.location.pathname;s.forEach(n=>{const a=n.getAttribute("href");a&&o.includes(a)&&(n.classList.add("nav-active"),n.addEventListener("click",i=>{i.preventDefault()}))}),document.body.appendChild(t),document.body.style.paddingBottom="70px"}export{v as S,m as l};
