import"./GoogleAuthManager-ldm7OoR_.js";import{S as E}from"./SheetsClient-DdnXSBEg.js";const n=s=>document.querySelector(s),p=(s,o="warning")=>{const e=n("#alert");e&&(e.className=`alert alert-${o}`,e.textContent=s,e.classList.remove("d-none"))};function I(s,o=320){const e=document.querySelector(s);if(!e)return null;const r=()=>{e.style.height="auto";const i=e.scrollHeight;i>o?(e.style.height=`${o}px`,e.style.overflowY="auto"):(e.style.height=`${i}px`,e.style.overflowY="hidden")};return e.addEventListener("input",r),window.addEventListener("resize",r),requestAnimationFrame(r),setTimeout(r,100),{resize:r}}document.addEventListener("DOMContentLoaded",async()=>{const s=new URLSearchParams(location.search),o=s.get("tab")||"Cadastro",e=Number(s.get("rowIndex")||NaN),r=n("#tab"),i=n("#rowIndex"),l=n("#nome"),u=n("#email"),m=n("#observacoes"),h=n("#form"),x=I("#observacoes",320);r&&(r.value=o),i&&(i.value=String(e));const b=new E;try{if(!Number.isInteger(e)||e<1)throw new Error("rowIndex inválido para edição (use >= 1).");const t=(await b.getObjectsWithIndex(o)).find(w=>w.rowIndex===e)?.object;if(!t)throw new Error("Registro não encontrado para o rowIndex informado.");const c=t.Nome??t?.nome??"",a=t.Email??t?.email??"",d=t.Observações??t.Observacoes??t?.observações??t?.observacoes??"";l&&(l.value=String(c)),u&&(u.value=String(a)),m&&(m.value=String(d),x?.resize())}catch(v){p(v?.message||"Erro ao carregar registro para edição.","danger")}h?.addEventListener("submit",async v=>{v.preventDefault();try{const t=await b.getHeaders(o),c=d=>{const w=t.map(f=>f.toLowerCase());if(d==="Observacoes"){const f=w.findIndex(y=>y.startsWith("observa"));return f>=0?t[f]:"Observacoes"}const g=w.indexOf(d.toLowerCase());return g>=0?t[g]:d},a={};l&&(a[c("Nome")]=(l.value||"").trim()),u&&(a[c("Email")]=(u.value||"").trim()),m&&(a[c("Observacoes")]=(m.value||"").trim()),await b.updateRowByIndex(o,e,a),p("Registro atualizado com sucesso!","success")}catch(t){p(t?.message||"Erro ao salvar alterações.","danger")}})});
