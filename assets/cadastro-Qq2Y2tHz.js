import"./modulepreload-polyfill-B5Qt9EMX.js";class c{sheetId;accessToken;constructor(e="19B2aMGrajvhPJfOvYXt059-fECytaN38iFsP8GInD_g"){if(this.sheetId=e,this.accessToken=localStorage.getItem("token"),!this.accessToken)throw new Error("Usuário não autenticado. Token não encontrado.")}get headers(){return{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"}}async request(e,s="GET",t){const o=await fetch(e,{method:s,headers:this.headers,body:t?JSON.stringify(t):void 0});if(!o.ok){const a=await o.json();throw console.error("Erro na requisição ao Google Sheets:",a),new Error(a.error.message||"Erro desconhecido")}return o.json()}async getHeaders(e){const s=`${e}!A1:Z1`,t=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${s}`;return(await this.request(t)).values?.[0]??[]}mapObjectToRow(e,s){return s.map(t=>e[t]??"")}async appendRowByHeader(e,s){const t=await this.getHeaders(e);if(t.length===0)throw new Error("Cabeçalhos não encontrados na planilha.");const o=[this.mapObjectToRow(s,t)],a=`${e}!A1`,r=`https://sheets.googleapis.com/v4/spreadsheets/${this.sheetId}/values/${a}:append?valueInputOption=RAW`;await this.request(r,"POST",{values:o})}}const i=new c,d=document.getElementById("formCadastro");d.addEventListener("submit",async n=>{n.preventDefault();const e=document.getElementById("nome").value,s=document.getElementById("email").value,t=document.getElementById("obs").value;await i.appendRowByHeader("Cadastro",{Nome:e,Email:s,Observacoes:t}),alert("Cadastro realizado com sucesso!")});
